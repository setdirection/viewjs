(function(f){function C(e,g,i,h){h={data:h||(g?g.data:{}),_wrap:g?g._wrap:null,tmpl:null,parent:g||null,nodes:[],calls:J,nest:K,wrap:O,html:L,update:x};e&&f.extend(h,e,{nodes:[],parent:g});if(i){h.tmpl=i;h._ctnt=h._ctnt||h.tmpl(f,h);h.key=++D;(y.length?u:s)[D]=h}return h}function q(e,g,i){var h;i=i?f.map(i,function(k){return typeof k==="string"?e.key?k.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+v+'="'+e.key+'" $2'):k:q(k,e,k._ctnt)}):e;if(g)return i;i=i.join("");i.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,
function(k,l,m,o){h=f(m).get();F(h);if(l)h=G(l).concat(h);if(o)h=h.concat(G(o))});return h?h:G(i)}function G(e){var g=document.createElement("div");g.innerHTML=e;return f.makeArray(g.childNodes)}function M(e){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+f.trim(e).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,
function(g,i,h,k,l,m,o){g=f.tmpl.tag[h];if(!g)throw"Template command not found: "+h;h=g._default||[];if(m&&!/\w$/.test(l)){l+=m;m=""}if(l){l=z(l);o=o?","+z(o)+")":m?")":"";o=m?l.indexOf(".")>-1?l+z(m):"("+l+").call($item"+o:l;m=m?o:"(typeof("+l+")==='function'?("+l+").call($item):("+l+"))"}else m=o=h.$1||"null";k=z(k);return"');"+g[i?"close":"open"].split("$notnull_1").join(l?"typeof("+l+")!=='undefined' && ("+l+")!=null":"true").split("$1a").join(m).split("$1").join(o).split("$2").join(k||h.$2||
"")+"_.push('"})+"');}return _;")}function H(e,g){e._wrap=q(e,true,f.isArray(g)?g:[I.test(g)?g:f(g).html()]).join("")}function z(e){return e?e.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function F(e){function g(a){function c(w){w+=i;j=l[w]=l[w]||C(j,s[j.parent.key+i]||j.parent)}var d,b=a,j,n;if(n=a.getAttribute(v)){for(;b.parentNode&&(b=b.parentNode).nodeType===1&&!(d=b.getAttribute(v)););if(d!==n){b=b.parentNode?b.nodeType===11?0:b.getAttribute(v)||0:0;if(!(j=s[n])){j=u[n];j=C(j,s[b]||u[b]);
j.key=++D;s[D]=j}r&&c(n)}a.removeAttribute(v)}else if(r&&(j=f.data(a,"tmplItem"))){c(j.key);s[j.key]=j;b=(b=f.data(a.parentNode,"tmplItem"))?b.key:0}if(j){for(d=j;d&&d.key!=b;){d.nodes.push(a);d=d.parent}delete j._ctnt;delete j._wrap;f.data(a,"tmplItem",j)}}var i="_"+r,h,k,l={},m,o,t;m=0;for(o=e.length;m<o;m++)if((h=e[m]).nodeType===1){k=h.getElementsByTagName("*");for(t=k.length-1;t>=0;t--)g(k[t]);g(h)}}function J(e,g,i,h){if(!e)return y.pop();y.push({_:e,tmpl:g,item:this,data:i,options:h})}function K(e,
g,i){return f.tmpl(f.template(e),g,i,this)}function O(e,g){var i=e.options||{};i.wrapped=g;return f.tmpl(f.template(e.tmpl),e.data,i,e.item)}function L(e,g){var i=this._wrap;return f.map(f(f.isArray(i)?i.join(""):i).filter(e||"*"),function(h){if(g)h=h.innerText||h.textContent;else{var k;if(!(k=h.outerHTML)){k=document.createElement("div");k.appendChild(h.cloneNode(true));k=k.innerHTML}h=k}return h})}function x(){var e=this.nodes;f.tmpl(null,null,null,this).insertBefore(e[0]);f(e).remove()}var E=f.fn.domManip,
v="_tmplitem",I=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,s={},u={},A,p={key:0,data:{}},D=0,r=0,y=[];f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,g){f.fn[e]=function(i){var h=[];i=f(i);var k,l,m;k=this.length===1&&this[0].parentNode;A=s||{};if(k&&k.nodeType===11&&k.childNodes.length===1&&i.length===1){i[g](this[0]);h=this}else{l=0;for(m=i.length;l<m;l++){r=l;k=(l>0?this.clone(true):this).get();f(i[l])[g](k);h=h.concat(k)}r=0;
h=this.pushStack(h,e,i.selector)}i=A;A=null;f.tmpl.complete(i);return h}});f.fn.extend({tmpl:function(e,g,i){return f.tmpl(this[0],e,g,i)},tmplItem:function(){return f.tmplItem(this[0])},template:function(e){return f.template(e,this[0])},domManip:function(e,g,i){if(e[0]&&f.isArray(e[0])){for(var h=f.makeArray(arguments),k=e[0],l=k.length,m=0,o;m<l&&!(o=f.data(k[m++],"tmplItem")););if(o&&r)h[2]=function(t){f.tmpl.afterManip(this,t,i)};E.apply(this,h)}else E.apply(this,arguments);r=0;A||f.tmpl.complete(s);
return this}});f.extend({tmpl:function(e,g,i,h){var k=!h;if(k){h=p;e=f.template[e]||f.template(null,e);u={}}else if(!e){e=h.tmpl;s[h.key]=h;h.nodes=[];h.wrapped&&H(h,h.wrapped);return f(q(h,null,h.tmpl(f,h)))}if(!e)return[];if(typeof g==="function")g=g.call(h||{});i&&i.wrapped&&H(i,i.wrapped);g=f.isArray(g)?f.map(g,function(l){return l?C(i,h,e,l):null}):[C(i,h,e,g)];return k?f(q(h,null,g)):g},tmplItem:function(e){var g;if(e instanceof f)e=e[0];for(;e&&e.nodeType===1&&!(g=f.data(e,"tmplItem"))&&(e=
e.parentNode););return g||p},template:function(e,g){if(g){if(typeof g==="string")g=M(g);else if(g instanceof f)g=g[0]||{};if(g.nodeType)g=f.data(g,"tmpl")||f.data(g,"tmpl",M(g.innerHTML));return typeof e==="string"?f.template[e]=g:g}return e?typeof e!=="string"?f.template(null,e):f.template[e]||f.template(null,I.test(e)?e:f(e)):null},encode:function(e){return(""+e).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});f.extend(f.tmpl,{tag:{tmpl:{_default:{$2:"null"},
open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},
"!":{open:""}},complete:function(){s={}},afterManip:function(e,g,i){var h=g.nodeType===11?f.makeArray(g.childNodes):g.nodeType===1?[g]:[];i.call(e,g);F(h);r++}})})(jQuery);
(function(f,C,q){function G(a,c){for(var d=["bind","unbind","one"],b=0;b<d.length;++b)(function(j){c[j]=y(c[j],function(n){var w=p(arguments).slice(1);a[j].apply(a,w);return n.apply(n,w)})})(d[b])}function M(a,c){var d=p(arguments).slice(1);d=a.apply(a,d);c=="ready"&&H(this);return d}function H(a){if(!a._readyEventFired&&a._element&&e(a._element)){a.trigger("ready");a._readyEventFired=true;a._readyEventInterval&&clearInterval(a._readyEventInterval)}else"_readyEventInterval"in a||setTimeout(function(){if(a._element&&
e(a._element)){a.trigger("ready");a._readyEventFired=true}else a._readyEventInterval=setInterval(function(){if(a._element&&e(a._element)){a.trigger("ready");a._readyEventFired=true;clearInterval(a._readyEventInterval);a._readyEventInterval=false}},10)})}function z(a,c,d,b){if(!(b===q||b===null||b===false)){if(typeof b==="function"&&!E(b))b=b();if(b&&b.element&&b.element().nodeType==1&&b._attributes||typeof b.element=="function")c.push(b.element());else if(E(b))c.push((new b).element());else{if(typeof b===
"function")b=b();if(typeof b!=="string"&&typeof b!=="number"&&!u(b)&&!v(b)&&!(b&&(b.nodeType===1||b.nodeType===3)))for(attribute_name in b)d[attribute_name]=b[attribute_name];else{if(s(a,b))b=a.render(b);if(v(b))b=b.toArray();if(u(b)){var j=K(b);for(b=0;b<j.length;++b)z(a,c,d,j[b])}else if(I(b)){a=J(b);for(b=0;b<a.length;++b)c.push(a[b])}else if(b&&(b.nodeType===1||b.nodeType===3)||typeof b==="string"||typeof b==="number")c.push(b)}}}}function F(a){var c,d,b,j,n;j=[];d={};for(c=1;c<arguments.length;++c)z(this,
j,d,arguments[c]);a=a.toLowerCase();if(g){if(document.attachEvent&&!C.opera&&(d.name||a=="input"&&d.type)){tag="<"+a;if(d.name)tag+=' name="'+d.name+'"';if(a=="input"&&d.type)tag+=' type="'+d.type+'"';tag+=">";delete d.name;delete d.type;n=document.createElement(tag)}else{l[a]||(l[a]=document.createElement(a));n=l[a].cloneNode(false)}f(n).attr(d);for(c=0;c<j.length;++c)j[c]&&(j[c].nodeType===1||j[c].nodeType===3)?n.appendChild(j[c]):n.appendChild(document.createTextNode(String(j[c])))}else{n="<"+
a;for(b in d)n+=" "+(o[b]||b)+'="'+d[b]+'"';if(j.length==0)n+=" />";else{n+=">";for(c=0;c<j.length;++c)n+=j[c];n+="</"+a+">"}}return n}function J(a){if(g){var c=F("div");c.innerHTML=a;return p(c.childNodes)}else return[a]}function K(a){for(var c=[],d=0;d<a.length;++d)if(u(a[d]))c=c.concat(K(a[d]));else c.push(a[d]);return c}function O(a){return function(){for(var c=[a],d=0;d<arguments.length;++d)c.push(arguments[d]);return F.apply(this,c)}}function L(a){for(var c in k)c in a||(a[c]=k[c])}function x(a,
c){for(var d in c)a[d]=c[d];return a}function E(a){return a&&a.prototype&&a.prototype._structure&&a.prototype.element}function v(a){return typeof a=="object"&&"jquery"in a&&"length"in a}function I(a){return typeof a=="string"&&a.match(/^<[\w\W]+>/)}function s(a,c){if(typeof c!="string"||!a||!("constructor"in a&&"engine"in a.constructor))return false;return a.constructor.engine().detect(c)}function u(a){return Object.prototype.toString.call(a)==="[object Array]"}function A(a,c){if(c.indexOf)return c.indexOf(a);
for(var d=0,b=c.length;d<b;d++)if(c[d]===a)return d;return-1}function p(a){if(!a)return[];for(var c=a.length||0,d=Array(c);c--;)d[c]=a[c];return d}function D(a){for(var c=p(arguments).slice(1),d=[],b=0;b<a.length;b++)A(a[b],c)>-1||d.push(a[b]);return d}function r(a,c){if(c===q)return a;if(arguments.length<3)return function(){return a.apply(c,arguments)};else{var d=p(arguments);d.shift();d.shift();return function(){return a.apply(c,d.concat(p(arguments)))}}}function y(a,c){return function(){return c.apply(this,
[r(a,this)].concat(p(arguments)))}}function e(a){for(a=a;a.parentNode;)a=a.parentNode;return!!a.body}var g="fn"in f&&"jquery"in f.fn;if(g&&Number(f.fn.jquery.replace(/\./g))<143)throw"jQuery View requires jQuery 1.4.3 or later.";f.view=function(a,c,d){if(a==="engine")if(typeof c==="string")h=c;else{i[c.name]=c;h=c.name}else{var b;if(E(a)){b=a;a=c;c=d}if(typeof a=="string"){var j=String(a);a=function(){return j}}d=function B(){this._delegates=[];this._observers={};this._attributes={};this._changes=
{};for(var N=0;N<this.constructor._methodsToProxy.length;++N)this[this.constructor._methodsToProxy[N]]=r(this[this.constructor._methodsToProxy[N]],this);this.initialize.apply(this,arguments);B._observers&&"ready"in B._observers&&H(this)};d._methodsToProxy=[];for(var n in c)d._methodsToProxy.push(n);d._observers={};d._instance=false;x(d,f.view.classMethods);if(b){x(d.prototype,b.prototype);d.prototype._structure=y(b.prototype._structure,function(B){B=r(B,this)();return a.apply(this,[B])||B});for(n=
0;n<b._methodsToProxy.length;++n)d._methodsToProxy.push(b._methodsToProxy[n])}else{x(d.prototype,f.view.fn);d.prototype._structure=a}d.prototype.bind=y(d.prototype.bind,M);if(b){d._observers={};for(var w in b._observers)d._observers[w]=b._observers[w];d.prototype._observers={};G(d,b)}x(d.prototype,c||{});return d}};f.view.classMethods={instance:function a(a){if(a===q){if(!this._instance)this._instance=new this}else this._instance=a;return this._instance},bind:function(a,c){var d=p(arguments);if(d[2]===
q)d[2]=this;c=r.apply(f.view,[c].concat(d.slice(2)));if(typeof a==="string"&&c!==q){a in this._observers||(this._observers[a]=[]);this._observers[a].push(c)}return c},unbind:function(a,c){a in this._observers||(this._observers[a]=[]);if(a&&c)this._observers[a]=D(this._observers[a],c);else if(a)this._observers[a]=[];else this._observers={}},one:function(a,c){var d=p(arguments);if(d[2]===q)d[2]=this;c=r.apply(f.view,[c].concat(d.slice(2)));var b=r(function(){var j=c.apply(this,arguments);this.unbind(a,
b);return j},this);a in this._observers||(this._observers[a]=[]);this._observers[a].push(b);return b},trigger:function(a){if(!this._observers||!this._observers[a]||this._observers[a]&&this._observers[a].length==0)return[];a in this._observers||(this._observers[a]=[]);for(var c=[],d=p(arguments).slice(1),b=0;b<this._observers[a].length;++b){var j=this._observers[a][b].apply(this._observers[a][b],d);if(j===false)return false;else c.push(j)}return c},ready:function(){var a=p(arguments);a.unshift("ready");
return this.bind.apply(this,a)},engine:function a(a){if(a===q)return i[this._engine===q?h:this._engine];else this._engine=a}};f.view.fn={initialize:function(a){this.length=0;f.view.logging&&console.log("jQuery.View: initialized ",this," with attributes:",a);this.attributes(a||{});(a=this._structure())&&!this._element&&this.element(a);if(g&&(!this._element||!this._element.nodeType||this._element.nodeType!==1))throw"The view constructor must return either a DOM element or jQuery object, or call this.element() with a DOM element. View constructor returned:"+
typeof this._element;this.trigger("initialized")},element:function a(a){if(a!==q){if(s(this,a))a=this.render(a);if(I(a))a=J(a)[0];else if(v(a))a=a[0];this._element=a;this.length=1;this[0]=this._element;if(this._delegates.length>0){for(var c=0;c<this._delegates.length;++c)this.delegate(this._delegates[c][0],this._delegates[c][1],this._delegates[c][2]);this._delegates=[]}}return this._element},attributes:function a(a,c){if(a!==q){var d={},b;for(b in this._attributes)d[b]=true;for(b in a){delete d[b];
this.set(b,a[b],true)}for(b in d){this._changes[b]=null;delete this._attributes[d[b]]}c===q&&this.trigger("change",this._changes,this);this._changes={}}return this._attributes},get:function(a){return this._attributes[a]},set:function(a,c,d){this._attributes[a]=c;this._changes[a]=c;if(d===q){this.trigger("change:"+a,c);this.trigger("change",this._changes);this._changes={}}return c},bind:f.view.classMethods.bind,unbind:f.view.classMethods.unbind,one:f.view.classMethods.one,trigger:function(a){if((!this.constructor._observers||
!this.constructor._observers[a]||this.constructor._observers[a]&&this.constructor._observers[a].length==0)&&(!this._observers||!this._observers[a]||this._observers[a]&&this._observers[a].length==0))return[];var c=p(arguments).slice(1),d=[];constructor_args=p(arguments).slice(1);constructor_args.unshift(this);constructor_args.unshift(a);var b=this.constructor.trigger.apply(this.constructor,constructor_args);if(b===false)return false;d=d.concat(b);a in this._observers||(this._observers[a]=[]);for(var j=
0;j<this._observers[a].length;++j){b=this._observers[a][j].apply(this._observers[a][j],c);if(b===false)return false;else d.push(b)}return d},ready:f.view.classMethods.ready,emit:function(){var a=p(arguments),c=this;return function(){return c.trigger.apply(c,a)}},map:function(a,c){var d=[];if(u(a))for(var b=0;b<a.length;++b)d.push(c.apply(this,[a[b],b]));else{b=0;for(var j in a){d.push(c.apply(this,[j,a[j],b]));++b}}return d},callback:function(a){var c=p(arguments).slice(1),d=this;return function(){return d[a].apply(d,
c)}},delegate:function(a,c,d,b){if(b)d=r(d,b);this._element?f(this._element).delegate(a,c,d):this._delegates.push([a,c,d])},escape:function(a){return document.createTextNode(a)},render:function(a,c){var d={},b;for(b in this)if(A(b,["_delegates","_observers","_attributes","_changes"])==-1)d[b]=this[b];x(d,this.attributes());x(d,c);return this.constructor.engine().render(a,d)}};f.view.logging=false;var i={},h;f.view("engine",{name:"jquery.tmpl",detect:function(a){return a.match(/\$\{[^\}]+\}/)},render:function(a,
c){return f.tmpl(a,c)}});for(var k={},l={},m="a abbr acronym address applet area b base basefont bdo big blockquote body br button canvas caption center cite code col colgroup dd del dfn dir div dl dt em embed fieldset font form frame frameset h1 h2 h3 h4 h5 h6 head hr html i iframe img input ins isindex kbd label legend li link menu meta nobr noframes noscript object ol optgroup option p param pre q s samp script select small span strike strong style sub sup table tbody td textarea tfoot th thead title tr tt u ul var article aside audio command details figcaption figure footer header hgroup keygen mark meter nav output progress rp ruby section source summary time video".split(/\s+/),
o={htmlFor:"for",className:"class"},t=0;t<m.length;++t)k[m[t]]=O(m[t]);L(f.view);L(f.view.fn)})("jQuery"in this?jQuery:"Zepto"in this?Zepto:this,this);
