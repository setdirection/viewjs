(function(f){function D(e,g,j,h){h={data:h||(g?g.data:{}),_wrap:g?g._wrap:null,tmpl:null,parent:g||null,nodes:[],calls:L,nest:M,wrap:P,html:N,update:y};e&&f.extend(h,e,{nodes:[],parent:g});if(j){h.tmpl=j;h._ctnt=h._ctnt||h.tmpl(f,h);h.key=++E;(z.length?t:s)[E]=h}return h}function q(e,g,j){var h;j=j?f.map(j,function(k){return typeof k==="string"?e.key?k.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+v+'="'+e.key+'" $2'):k:q(k,e,k._ctnt)}):e;if(g)return j;j=j.join("");j.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,
function(k,l,m,o){h=f(m).get();H(h);if(l)h=I(l).concat(h);if(o)h=h.concat(I(o))});return h?h:I(j)}function I(e){var g=document.createElement("div");g.innerHTML=e;return f.makeArray(g.childNodes)}function O(e){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+f.trim(e).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,
function(g,j,h,k,l,m,o){g=f.tmpl.tag[h];if(!g)throw"Template command not found: "+h;h=g._default||[];if(m&&!/\w$/.test(l)){l+=m;m=""}if(l){l=A(l);o=o?","+A(o)+")":m?")":"";o=m?l.indexOf(".")>-1?l+A(m):"("+l+").call($item"+o:l;m=m?o:"(typeof("+l+")==='function'?("+l+").call($item):("+l+"))"}else m=o=h.$1||"null";k=A(k);return"');"+g[j?"close":"open"].split("$notnull_1").join(l?"typeof("+l+")!=='undefined' && ("+l+")!=null":"true").split("$1a").join(m).split("$1").join(o).split("$2").join(k||h.$2||
"")+"_.push('"})+"');}return _;")}function J(e,g){e._wrap=q(e,true,f.isArray(g)?g:[K.test(g)?g:f(g).html()]).join("")}function A(e){return e?e.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function H(e){function g(a){function c(x){x+=j;i=l[x]=l[x]||D(i,s[i.parent.key+j]||i.parent)}var d,b=a,i,n;if(n=a.getAttribute(v)){for(;b.parentNode&&(b=b.parentNode).nodeType===1&&!(d=b.getAttribute(v)););if(d!==n){b=b.parentNode?b.nodeType===11?0:b.getAttribute(v)||0:0;if(!(i=s[n])){i=t[n];i=D(i,s[b]||t[b]);
i.key=++E;s[E]=i}r&&c(n)}a.removeAttribute(v)}else if(r&&(i=f.data(a,"tmplItem"))){c(i.key);s[i.key]=i;b=(b=f.data(a.parentNode,"tmplItem"))?b.key:0}if(i){for(d=i;d&&d.key!=b;){d.nodes.push(a);d=d.parent}delete i._ctnt;delete i._wrap;f.data(a,"tmplItem",i)}}var j="_"+r,h,k,l={},m,o,u;m=0;for(o=e.length;m<o;m++)if((h=e[m]).nodeType===1){k=h.getElementsByTagName("*");for(u=k.length-1;u>=0;u--)g(k[u]);g(h)}}function L(e,g,j,h){if(!e)return z.pop();z.push({_:e,tmpl:g,item:this,data:j,options:h})}function M(e,
g,j){return f.tmpl(f.template(e),g,j,this)}function P(e,g){var j=e.options||{};j.wrapped=g;return f.tmpl(f.template(e.tmpl),e.data,j,e.item)}function N(e,g){var j=this._wrap;return f.map(f(f.isArray(j)?j.join(""):j).filter(e||"*"),function(h){if(g)h=h.innerText||h.textContent;else{var k;if(!(k=h.outerHTML)){k=document.createElement("div");k.appendChild(h.cloneNode(true));k=k.innerHTML}h=k}return h})}function y(){var e=this.nodes;f.tmpl(null,null,null,this).insertBefore(e[0]);f(e).remove()}var F=f.fn.domManip,
v="_tmplitem",K=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,s={},t={},B,p={key:0,data:{}},E=0,r=0,z=[];f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,g){f.fn[e]=function(j){var h=[];j=f(j);var k,l,m;k=this.length===1&&this[0].parentNode;B=s||{};if(k&&k.nodeType===11&&k.childNodes.length===1&&j.length===1){j[g](this[0]);h=this}else{l=0;for(m=j.length;l<m;l++){r=l;k=(l>0?this.clone(true):this).get();f(j[l])[g](k);h=h.concat(k)}r=0;
h=this.pushStack(h,e,j.selector)}j=B;B=null;f.tmpl.complete(j);return h}});f.fn.extend({tmpl:function(e,g,j){return f.tmpl(this[0],e,g,j)},tmplItem:function(){return f.tmplItem(this[0])},template:function(e){return f.template(e,this[0])},domManip:function(e,g,j){if(e[0]&&f.isArray(e[0])){for(var h=f.makeArray(arguments),k=e[0],l=k.length,m=0,o;m<l&&!(o=f.data(k[m++],"tmplItem")););if(o&&r)h[2]=function(u){f.tmpl.afterManip(this,u,j)};F.apply(this,h)}else F.apply(this,arguments);r=0;B||f.tmpl.complete(s);
return this}});f.extend({tmpl:function(e,g,j,h){var k=!h;if(k){h=p;e=f.template[e]||f.template(null,e);t={}}else if(!e){e=h.tmpl;s[h.key]=h;h.nodes=[];h.wrapped&&J(h,h.wrapped);return f(q(h,null,h.tmpl(f,h)))}if(!e)return[];if(typeof g==="function")g=g.call(h||{});j&&j.wrapped&&J(j,j.wrapped);g=f.isArray(g)?f.map(g,function(l){return l?D(j,h,e,l):null}):[D(j,h,e,g)];return k?f(q(h,null,g)):g},tmplItem:function(e){var g;if(e instanceof f)e=e[0];for(;e&&e.nodeType===1&&!(g=f.data(e,"tmplItem"))&&(e=
e.parentNode););return g||p},template:function(e,g){if(g){if(typeof g==="string")g=O(g);else if(g instanceof f)g=g[0]||{};if(g.nodeType)g=f.data(g,"tmpl")||f.data(g,"tmpl",O(g.innerHTML));return typeof e==="string"?f.template[e]=g:g}return e?typeof e!=="string"?f.template(null,e):f.template[e]||f.template(null,K.test(e)?e:f(e)):null},encode:function(e){return(""+e).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});f.extend(f.tmpl,{tag:{tmpl:{_default:{$2:"null"},
open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},
"!":{open:""}},complete:function(){s={}},afterManip:function(e,g,j){var h=g.nodeType===11?f.makeArray(g.childNodes):g.nodeType===1?[g]:[];j.call(e,g);H(h);r++}})})(jQuery);
(function(f,D,q){function I(a,c){for(var d=["bind","unbind","one"],b=0;b<d.length;++b)(function(i){c[i]=z(c[i],function(n){var x=p(arguments).slice(1);a[i].apply(a,x);return n.apply(n,x)})})(d[b])}function O(a,c){var d=p(arguments).slice(1);d=a.apply(a,d);c=="ready"&&J(this);return d}function J(a){if(!a._readyEventFired&&a._element&&e(a._element)){a.trigger("ready");a._readyEventFired=true;a._readyEventInterval&&clearInterval(a._readyEventInterval)}else"_readyEventInterval"in a||setTimeout(function(){if(a._element&&
e(a._element)){a.trigger("ready");a._readyEventFired=true}else a._readyEventInterval=setInterval(function(){if(a._element&&e(a._element)){a.trigger("ready");a._readyEventFired=true;clearInterval(a._readyEventInterval);a._readyEventInterval=false}},10)})}function A(a,c,d,b){if(!(b===q||b===null||b===false)){if(typeof b==="function"&&!F(b))b=b();if(b&&b.element&&b.element().nodeType==1&&b._attributes||typeof b.element=="function")c.push(b.element());else if(F(b))c.push((new b).element());else{if(typeof b===
"function")b=b();if(typeof b!=="string"&&typeof b!=="number"&&!t(b)&&!v(b)&&!(b&&(b.nodeType===1||b.nodeType===3)))for(attribute_name in b)d[attribute_name]=b[attribute_name];else{if(s(a,b))b=a.render(b);if(v(b))b=b.toArray();if(t(b)){var i=M(b);for(b=0;b<i.length;++b)A(a,c,d,i[b])}else if(K(b)){a=L(b);for(b=0;b<a.length;++b)c.push(a[b])}else if(b&&(b.nodeType===1||b.nodeType===3)||typeof b==="string"||typeof b==="number")c.push(b)}}}}function H(a){var c,d,b,i,n;i=[];d={};for(c=1;c<arguments.length;++c)A(this,
i,d,arguments[c]);a=a.toLowerCase();if(g){if(document.attachEvent&&!D.opera&&(d.name||a=="input"&&d.type)){tag="<"+a;if(d.name)tag+=' name="'+d.name+'"';if(a=="input"&&d.type)tag+=' type="'+d.type+'"';tag+=">";delete d.name;delete d.type;n=document.createElement(tag)}else{l[a]||(l[a]=document.createElement(a));n=l[a].cloneNode(false)}f(n).attr(d);for(c=0;c<i.length;++c)i[c]&&(i[c].nodeType===1||i[c].nodeType===3)?n.appendChild(i[c]):n.appendChild(document.createTextNode(String(i[c])))}else{n="<"+
a;for(b in d)n+=" "+(o[b]||b)+'="'+d[b]+'"';if(i.length==0)n+=" />";else{n+=">";for(c=0;c<i.length;++c)n+=i[c];n+="</"+a+">"}}return n}function L(a){if(g){var c=H("div");c.innerHTML=a;return p(c.childNodes)}else return[a]}function M(a){for(var c=[],d=0;d<a.length;++d)if(t(a[d]))c=c.concat(M(a[d]));else c.push(a[d]);return c}function P(a){return function(){for(var c=[a],d=0;d<arguments.length;++d)c.push(arguments[d]);return H.apply(this,c)}}function N(a){for(var c in k)c in a||(a[c]=k[c])}function y(a,
c){for(var d in c)a[d]=c[d];return a}function F(a){return a&&a.prototype&&a.prototype.initialize&&a.prototype.element}function v(a){return a&&typeof a=="object"&&"jquery"in a&&"length"in a}function K(a){return typeof a=="string"&&a.match(/^<[\w\W]+>/)}function s(a,c){if(typeof c!="string"||!a||!("constructor"in a&&"engine"in a.constructor))return false;return a.constructor.engine().detect(c)}function t(a){return Object.prototype.toString.call(a)==="[object Array]"}function B(a,c){if(c.indexOf)return c.indexOf(a);
for(var d=0,b=c.length;d<b;d++)if(c[d]===a)return d;return-1}function p(a){if(!a)return[];for(var c=a.length||0,d=Array(c);c--;)d[c]=a[c];return d}function E(a){for(var c=p(arguments).slice(1),d=[],b=0;b<a.length;b++)B(a[b],c)>-1||d.push(a[b]);return d}function r(a,c){if(c===q)return a;if(arguments.length<3)return function(){return a.apply(c,arguments)};else{var d=p(arguments);d.shift();d.shift();return function(){return a.apply(c,d.concat(p(arguments)))}}}function z(a,c){return function(){return c.apply(this,
[r(a,this)].concat(p(arguments)))}}function e(a){for(a=a;a.parentNode;)a=a.parentNode;return!!a.body}var g="fn"in f&&"jquery"in f.fn;if(g&&Number(f.fn.jquery.replace(/\./g))<143)throw"jQuery View requires jQuery 1.4.3 or later.";f.view=function(a,c){if(a==="engine")if(typeof c==="string")h=c;else{j[c.name]=c;h=c.name}else{var d=false;if(F(a)){d=a;if(arguments.length==2&&typeof arguments[1]==="object"){c=arguments[1];if("initialize"in c){a=c.initialize;delete c.initialize}else a=function(){}}else{a=
arguments[1];c=arguments[2]}}else if(c===q&&typeof a==="object")if("initialize"in a){c=a;a=c.initialize;delete c.initialize}else throw'"initialize" method must be specified to create a $.view class.';if(typeof a=="string"){var b=String(a);a=function(){return b}}var i=function C(w,Q){this._element=null;this._delegates=[];this._observers={};this._attributes={};this._changes={};if(v(w))w=w[0];if(w&&typeof w==="object"&&w.nodeType===1){this.element(w);w=Q||{}}for(var G=0;G<this.constructor._methodsToProxy.length;++G)this[this.constructor._methodsToProxy[G]]=
r(this[this.constructor._methodsToProxy[G]],this);this.length=0;f.view.logging&&console.log("jQuery.View: initialized ",this," with attributes:",w);this.attributes(w||{});(G=this.initialize(this.element()))&&!this._element&&this.element(G);if(g&&(!this._element||!this._element.nodeType||this._element.nodeType!==1))throw"The view constructor must return either a DOM element or jQuery object, or call this.element() with a DOM element. View constructor returned:"+typeof this._element;this.trigger("initialized");
C._observers&&"ready"in C._observers&&J(this)};i._methodsToProxy=[];for(var n in c)i._methodsToProxy.push(n);i._observers={};i._instance=false;y(i,f.view.classMethods);if(d){y(i.prototype,d.prototype);i.prototype.initialize=z(d.prototype.initialize,function(C){C=r(C,this)()||this.element();return a.apply(this,[C])||this.element()||C});for(n=0;n<d._methodsToProxy.length;++n)i._methodsToProxy.push(d._methodsToProxy[n])}else{y(i.prototype,f.view.fn);i.prototype.initialize=a}i.prototype.bind=z(i.prototype.bind,
O);if(d){i._observers={};for(var x in d._observers)i._observers[x]=d._observers[x];i.prototype._observers={};I(i,d)}y(i.prototype,c||{});return i}};f.view.classMethods={instance:function a(a){if(a===q){if(!this._instance)this._instance=new this}else this._instance=a;return this._instance},bind:function(a,c){if(typeof a==="object"){var d={},b;for(b in a)d[b]=this.bind(b,a[b]);return d}else{d=p(arguments);if(d[2]===q)d[2]=this;c=r.apply(f.view,[c].concat(d.slice(2)));if(typeof a==="string"&&c!==q){a in
this._observers||(this._observers[a]=[]);this._observers[a].push(c)}return c}},unbind:function(a,c){a in this._observers||(this._observers[a]=[]);if(a&&c)this._observers[a]=E(this._observers[a],c);else if(a)this._observers[a]=[];else this._observers={}},one:function(a,c){var d=p(arguments);if(d[2]===q)d[2]=this;c=r.apply(f.view,[c].concat(d.slice(2)));var b=r(function(){var i=c.apply(this,arguments);this.unbind(a,b);return i},this);a in this._observers||(this._observers[a]=[]);this._observers[a].push(b);
return b},trigger:function(a){if(!this._observers||!this._observers[a]||this._observers[a]&&this._observers[a].length==0)return[];a in this._observers||(this._observers[a]=[]);for(var c=[],d=p(arguments).slice(1),b=0;b<this._observers[a].length;++b){var i=this._observers[a][b].apply(this._observers[a][b],d);if(i===false)return false;else c.push(i)}return c},ready:function(){var a=p(arguments);a.unshift("ready");return this.bind.apply(this,a)},engine:function a(a){if(a===q)return j[this._engine===
q?h:this._engine];else this._engine=a}};f.view.fn={element:function a(a){if(a!==q){if(typeof a==="function")a=a.apply(this,[]);if(s(this,a))a=this.render(a);if(K(a))a=L(a)[0];else if(v(a))a=a[0];this._element=a;this.length=1;this[0]=this._element;if(this._delegates.length>0){for(var c=0;c<this._delegates.length;++c)this.delegate(this._delegates[c][0],this._delegates[c][1],this._delegates[c][2]);this._delegates=[]}}return this._element},attributes:function a(a,c){if(a!==q){var d={},b;for(b in this._attributes)d[b]=
true;for(b in a){delete d[b];this.set(b,a[b],true)}for(b in d){this._changes[b]=null;delete this._attributes[d[b]]}c===q&&this.trigger("change",this._changes,this);this._changes={}}return this._attributes},get:function(a){if(arguments.length>1||t(a)){var c=[],d;d=t(a)?a:p(arguments);for(var b=0;b<d.length;++b)c.push(this.get(d[b]));return c}else if(typeof a==="string"||typeof a=="number")return this._attributes[a]},set:function(a,c,d){if(typeof a==="object"){d={};for(var b in a)d[b]=this.set(b,a[b],
c);return d}else{this._attributes[a]=c;this._changes[a]=c;if(d===q){this.trigger("change:"+a,c);this.trigger("change",this._changes);this._changes={}}return c}},bind:f.view.classMethods.bind,unbind:f.view.classMethods.unbind,one:f.view.classMethods.one,trigger:function(a){if((!this.constructor._observers||!this.constructor._observers[a]||this.constructor._observers[a]&&this.constructor._observers[a].length==0)&&(!this._observers||!this._observers[a]||this._observers[a]&&this._observers[a].length==
0))return[];var c=p(arguments).slice(1),d=[];constructor_args=p(arguments).slice(1);constructor_args.unshift(this);constructor_args.unshift(a);var b=this.constructor.trigger.apply(this.constructor,constructor_args);if(b===false)return false;d=d.concat(b);a in this._observers||(this._observers[a]=[]);for(var i=0;i<this._observers[a].length;++i){b=this._observers[a][i].apply(this._observers[a][i],c);if(b===false)return false;else d.push(b)}return d},ready:f.view.classMethods.ready,emit:function(){var a=
p(arguments),c=this;return function(){return c.trigger.apply(c,a)}},map:function(a,c,d){d=d||[];if(typeof a==="string")a=this.get(a);if(t(a))for(var b=0;b<a.length;++b)d.push(c.apply(this,[a[b],b]));else{b=0;for(var i in a){typeof a[i]==="function"?this.map(this.get(i),a[i],d):d.push(c.apply(this,[i,a[i],b]));++b}}return d},callback:function(a){var c=p(arguments).slice(1),d=this;return function(){return d[a].apply(d,c)}},delegate:function(a,c,d,b){if(b)d=r(d,b);this._element?f(this._element).delegate(a,
c,d):this._delegates.push([a,c,d])},escape:function(a){return document.createTextNode(a)},render:function(a,c){var d={},b;for(b in this)if(B(b,["_delegates","_observers","_attributes","_changes"])==-1)d[b]=this[b];y(d,this.attributes());y(d,c);return this.constructor.engine().render(a,d)}};f.view.logging=false;var j={},h;f.view("engine",{name:"jquery.tmpl",detect:function(a){return a.match(/\$\{[^\}]+\}/)},render:function(a,c){return f.tmpl(a,c)}});for(var k={},l={},m="a abbr acronym address applet area b base basefont bdo big blockquote body br button canvas caption center cite code col colgroup dd del dfn dir div dl dt em embed fieldset font form frame frameset h1 h2 h3 h4 h5 h6 head hr html i iframe img input ins isindex kbd label legend li link menu meta nobr noframes noscript object ol optgroup option p param pre q s samp script select small span strike strong style sub sup table tbody td textarea tfoot th thead title tr tt u ul var article aside audio command details figcaption figure footer header hgroup keygen mark meter nav output progress rp ruby section source summary time video".split(/\s+/),
o={htmlFor:"for",className:"class"},u=0;u<m.length;++u)k[m[u]]=P(m[u]);N(f.view);N(f.view.fn)})("jQuery"in this?jQuery:"Zepto"in this?Zepto:this,this);
